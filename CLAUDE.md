# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a **Wardle** project built with **TanStack Start** - a full-stack React framework powered by TanStack Router. The app uses React 19, Tailwind CSS v4, and runs on Bun with Nitro as the server runtime.

## Development Commands

**Start development server:**
```bash
bun --bun run dev
# Runs on http://localhost:3000
```

**Run tests:**
```bash
bun --bun run test        # Run all tests with Vitest
```

**Linting and formatting:**
```bash
bun --bun run lint        # Run ESLint
bun --bun run format      # Run Prettier
bun --bun run check       # Format and lint fix in one command
```

**Build for production:**
```bash
bun --bun run build
```

**Preview production build:**
```bash
bun --bun run serve
```

## Architecture

### File-Based Routing

Routes are automatically generated from files in `src/routes/`:
- `src/routes/index.tsx` → `/`
- `src/routes/__root.tsx` → Root layout (wraps all routes)
- `src/routes/path/to/page.tsx` → `/path/to/page`
- `src/routes/api.endpoint.ts` → `/api/endpoint` (API route)

**Creating a new route:** Simply add a `.tsx` file in `src/routes/` and the route is automatically created.

**Route file pattern:**
```typescript
export const Route = createFileRoute('/path')({
  component: ComponentName,
  loader: async () => { /* data fetching */ },
  head: () => ({ /* meta tags */ })
})
```

### Key Files

- `src/router.tsx` - Router instance configuration
- `src/routeTree.gen.ts` - **Auto-generated, DO NOT EDIT** - Generated by TanStack Router plugin
- `src/routes/__root.tsx` - Root layout using `shellComponent` for full document control (includes `<html>`, `<head>`, `<body>`)

### Path Aliases

TypeScript path alias `@/*` maps to `src/*`:
```typescript
import { Component } from '@/components/Component'
```

### Server-Side Code

Use `createServerFn()` for server-only code that can access Node.js APIs:
```typescript
const serverFn = createServerFn({ method: 'GET' })
  .handler(async () => {
    // Server-side code here (can use fs, etc.)
  })
```

### API Routes

Create API endpoints using the `server` property in route files:
```typescript
export const Route = createFileRoute('/api/path')({
  server: {
    handlers: {
      GET: () => json(data),
      POST: async ({ request }) => { /* handle POST */ }
    },
  },
})
```

### Data Loading

Access loader data in components:
```typescript
const data = Route.useLoaderData()
```

Invalidate router to refetch data:
```typescript
const router = useRouter()
router.invalidate()
```

### Navigation

Use the `Link` component for SPA navigation:
```typescript
import { Link } from '@tanstack/react-router'

<Link
  to="/path"
  activeProps={{ className: 'font-bold' }}
>
  Link Text
</Link>
```

## Project Structure

```
src/
├── routes/              # File-based routes
│   ├── __root.tsx      # Root layout with HTML shell
│   ├── index.tsx       # Home page
│   └── demo/           # Demo routes (safe to delete)
├── components/         # React components
│   └── Header.tsx      # Navigation header
├── data/              # Data layer / server functions
├── router.tsx         # Router configuration
├── routeTree.gen.ts   # Auto-generated (DO NOT EDIT)
└── styles.css         # Global Tailwind styles
```

## Important Conventions

1. **Generated Files:** Never manually edit `src/routeTree.gen.ts` - it's auto-generated by the TanStack Router plugin
2. **Demo Files:** Files in `src/routes/demo/` and `src/data/demo.punk-songs.ts` are examples and can be safely deleted
3. **Bun Runtime:** This project uses Bun, not npm/pnpm/yarn - always use `bun` commands
4. **Root Route:** The `__root.tsx` uses `shellComponent` which means it controls the entire HTML document structure
5. **SSR:** TanStack Start provides SSR capabilities out of the box - routes are server-rendered by default

## Code Style

- **No semicolons** (enforced by Prettier)
- **Single quotes** for strings
- **Trailing commas** in objects and arrays
- Tailwind utility classes for styling
- ESLint config from `@tanstack/eslint-config`

## Tech Stack Details

- **Runtime:** Bun
- **Framework:** TanStack Start (React 19)
- **Router:** TanStack Router v1.132.0 (file-based)
- **Styling:** Tailwind CSS v4 with Vite plugin
- **Build Tool:** Vite v7
- **Server:** Nitro
- **Testing:** Vitest with React Testing Library
- **Icons:** Lucide React
- **DevTools:** TanStack Router Devtools, React Devtools
